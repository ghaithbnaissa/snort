# ==========================================
# Snort Local Rules for DDoS Detection
# Network: VLAN 10 (192.168.10.0/24)
# File: /etc/snort/rules/local.rules
# ==========================================

# ICMP Flood Detection
alert icmp any any -> $HOME_NET any (msg:"ICMP Flood Detected"; \
    threshold: type both, track by_src, count 100, seconds 1; \
    sid:9000001; rev:1; classtype:attempted-dos; priority:1;)

# TCP SYN Flood Detection
alert tcp any any -> $HOME_NET any (msg:"TCP SYN Flood Detected"; \
    flags:S; \
    threshold: type both, track by_src, count 100, seconds 1; \
    sid:9000002; rev:1; classtype:attempted-dos; priority:1;)

# UDP Flood Detection
alert udp any any -> $HOME_NET any (msg:"UDP Flood Detected"; \
    threshold: type both, track by_src, count 100, seconds 1; \
    sid:9000003; rev:1; classtype:attempted-dos; priority:1;)

# HTTP GET Flood Detection
alert tcp any any -> $HOME_NET 80 (msg:"HTTP GET Flood Detected"; \
    content:"GET"; http_method; \
    threshold: type both, track by_src, count 50, seconds 1; \
    sid:9000004; rev:1; classtype:attempted-dos; priority:1;)

# HTTP POST Flood Detection
alert tcp any any -> $HOME_NET 80 (msg:"HTTP POST Flood Detected"; \
    content:"POST"; http_method; \
    threshold: type both, track by_src, count 30, seconds 1; \
    sid:9000005; rev:1; classtype:attempted-dos; priority:1;)

# DNS Amplification Attack Detection
alert udp any 53 -> $HOME_NET any (msg:"Possible DNS Amplification Attack"; \
    byte_test:2,>,512,2; \
    threshold: type both, track by_src, count 10, seconds 1; \
    sid:9000006; rev:1; classtype:attempted-dos; priority:1;)

# Port Scan Detection
alert tcp any any -> $HOME_NET any (msg:"Port Scan Detected"; \
    flags:S; \
    detection_filter: track by_src, count 20, seconds 10; \
    sid:9000007; rev:1; classtype:attempted-recon; priority:2;)

# FIN Scan Detection
alert tcp any any -> $HOME_NET any (msg:"FIN Scan Detected"; \
    flags:F; \
    detection_filter: track by_src, count 15, seconds 10; \
    sid:9000008; rev:1; classtype:attempted-recon; priority:2;)

# NULL Scan Detection
alert tcp any any -> $HOME_NET any (msg:"NULL Scan Detected"; \
    flags:0; \
    detection_filter: track by_src, count 15, seconds 10; \
    sid:9000009; rev:1; classtype:attempted-recon; priority:2;)

# XMAS Scan Detection
alert tcp any any -> $HOME_NET any (msg:"XMAS Scan Detected"; \
    flags:FPU; \
    detection_filter: track by_src, count 15, seconds 10; \
    sid:9000010; rev:1; classtype:attempted-recon; priority:2;)

# SSH Brute Force Detection
alert tcp any any -> $HOME_NET 22 (msg:"SSH Brute Force Attempt"; \
    flags:S; \
    threshold: type both, track by_src, count 5, seconds 60; \
    sid:9000011; rev:1; classtype:attempted-admin; priority:1;)

# FTP Brute Force Detection
alert tcp any any -> $HOME_NET 21 (msg:"FTP Brute Force Attempt"; \
    flags:S; \
    threshold: type both, track by_src, count 5, seconds 60; \
    sid:9000012; rev:1; classtype:attempted-admin; priority:1;)

# Slowloris Attack Detection
alert tcp any any -> $HOME_NET 80 (msg:"Slowloris Attack Detected"; \
    flow:to_server,established; \
    content:"User-Agent|3a 20|"; \
    threshold: type both, track by_src, count 50, seconds 60; \
    sid:9000013; rev:1; classtype:attempted-dos; priority:1;)

# Large ICMP Packet (Ping of Death)
alert icmp any any -> $HOME_NET any (msg:"Large ICMP Packet - Possible Ping of Death"; \
    dsize:>1024; \
    sid:9000014; rev:1; classtype:attempted-dos; priority:1;)

# NTP Amplification Attack
alert udp any 123 -> $HOME_NET any (msg:"Possible NTP Amplification Attack"; \
    byte_test:1,>,100,0; \
    threshold: type both, track by_src, count 10, seconds 1; \
    sid:9000015; rev:1; classtype:attempted-dos; priority:1;)

# SSDP Amplification Attack
alert udp any 1900 -> $HOME_NET any (msg:"Possible SSDP Amplification Attack"; \
    content:"M-SEARCH"; depth:8; \
    threshold: type both, track by_src, count 10, seconds 1; \
    sid:1000016; rev:1; classtype:attempted-dos; priority:1;)